<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>å†™æ–‡ç«  â€” Markdown ç¼–è¾‘å™¨</title>
  <style>
    :root{--bg1:#071026;--bg2:#061027;--surface:#071026;--text:#e6eef8;--muted:#94a3b8;--accent:#60a5fa;--card-border:rgba(255,255,255,0.03)}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial;margin:0;background:linear-gradient(180deg,var(--bg1),var(--bg2));color:var(--text);transition:background-color .25s,color .25s}
    body.light{--bg1:#f5f7fb;--bg2:#fff;--surface:#fff;--text:#0b1220;--muted:#6b7280;--accent:#2563eb;--card-border:rgba(2,6,23,0.06)}
    .wrap{max-width:1100px;margin:20px auto;display:grid;grid-template-columns:1fr 1fr;gap:12px;padding:12px}
    .panel{background:var(--surface);padding:12px;border-radius:8px;border:1px solid var(--card-border)}
    input,textarea{width:100%;padding:8px;border-radius:6px;border:1px solid var(--card-border);background:transparent;color:inherit}
    textarea{height:420px;font-family:ui-monospace,monospace}
    .row{display:flex;gap:8px;margin-bottom:8px}
    .btn{background:var(--surface);padding:8px 12px;border-radius:8px;color:var(--text);text-decoration:none;border:1px solid var(--card-border);cursor:pointer}
    .muted{color:var(--muted)}
    @media(max-width:900px){.wrap{grid-template-columns:1fr}}
    .theme-toggle{position:fixed;right:14px;top:14px;background:var(--surface);color:var(--text);border:1px solid var(--card-border);padding:8px;border-radius:8px;cursor:pointer}
  </style>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
  <div class="wrap">
    <div class="panel">
      <div class="row"><input id="title" placeholder="æ–‡ç« æ ‡é¢˜"></div>
      <div class="row"><input id="tags" placeholder="æ ‡ç­¾ï¼Œé€—å·åˆ†éš”"></div>
      <textarea id="md" placeholder="# åœ¨è¿™é‡Œå†™ Markdown"></textarea>
      <div style="margin-top:8px;display:flex;gap:8px;justify-content:flex-end">
        <button class="btn" id="download">ä¸‹è½½ .md</button>
        <button class="btn" id="copyHtml">å¤åˆ¶ HTML</button>
      </div>
      <p class="muted">è¯´æ˜ï¼šæ­¤ç¼–è¾‘å™¨æ”¯æŒæœ¬åœ°å¯¼å‡º Markdownã€‚è¦ç›´æ¥å‘å¸ƒåˆ° GitHubï¼Œå¯ä½¿ç”¨ä¸ªäººè®¿é—®ä»¤ç‰Œï¼ˆPATï¼‰ï¼Œä½†è¯·è°¨æ…å¤„ç†ã€‚</p>
    </div>

    <div class="panel">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px"><strong>å®æ—¶é¢„è§ˆ</strong><a href="posts/" class="muted">/posts/</a></div>
      <div id="preview" style="overflow:auto;height:520px;padding:6px;background:#041025;border-radius:6px"></div>
    </div>
  </div>

  <script>
    const mdEl = document.getElementById('md');
    const prev = document.getElementById('preview');
    const titleEl = document.getElementById('title');
    const tagsEl = document.getElementById('tags');
    function render(){prev.innerHTML = marked.parse(mdEl.value||'');}
    mdEl.addEventListener('input', render); titleEl.addEventListener('input', ()=>{});
    render();

    document.getElementById('download').addEventListener('click', ()=>{
      const title = (titleEl.value||'untitled').trim();
      const slug = title.toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,'')||'post';
      const filename = `posts/${slug}.md`;
      const front = `---\ntitle: ${title}\ndate: ${new Date().toISOString()}\ntags: [${tagsEl.value}]\n---\n\n`;
      const blob = new Blob([front + mdEl.value], {type:'text/markdown;charset=utf-8'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = filename; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

    document.getElementById('copyHtml').addEventListener('click', async ()=>{
      const html = marked.parse(mdEl.value||'');
      try{await navigator.clipboard.writeText(html); alert('å·²å¤åˆ¶ HTML åˆ°å‰ªè´´æ¿');}catch(e){alert('å¤åˆ¶å¤±è´¥ï¼š'+e)}
    });
  </script>
  <button id="globalThemeBtn" class="theme-toggle" title="åˆ‡æ¢æ—¥/å¤œæ¨¡å¼">ğŸŒ™</button>
  <script>
    const gBtn = document.getElementById('globalThemeBtn');
    function applyThemePage(t){ if(t==='light') document.body.classList.add('light'); else document.body.classList.remove('light'); gBtn.textContent = document.body.classList.contains('light') ? 'â˜€ï¸' : 'ğŸŒ™'; try{localStorage.setItem('site-theme', t)}catch(e){} }
    (function(){ let t='dark'; try{const s=localStorage.getItem('site-theme'); if(s) t=s;}catch(e){} applyThemePage(t); gBtn.addEventListener('click', ()=>{const cur=document.body.classList.contains('light')?'light':'dark'; applyThemePage(cur==='light'?'dark':'light');}); })();
  </script>
</body>
</html>
